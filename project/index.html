<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StarW1N КЕЙСЫ</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap" rel="stylesheet">

<style>
  body{
    margin:0;
    background:#0a0f1a;
    font-family:'Montserrat',sans-serif;
    height:200vh;

    /* ADAPTIVE FIX */
    display:flex;
    flex-direction:column;
    align-items:center;
  }

  /* АДАПТИВНАЯ ГЛОБАЛЬНАЯ ШИРИНА */
  .page-wrapper{
    width:100%;
    max-width:600px; /* чтобы сайт не растягивался на телефоне */
    position:relative;
  }

  /* Логотип */
  .logo-bar{
    position:fixed;
    top:0;
    left:50%;
    transform:translateX(-50%);
    width:100%;
    max-width:600px; /* ADAPTIVE FIX */
    padding:20px 0;
    display:flex;
    justify-content:center;
    background:#0a0f1a;
    z-index:999;
    transition:transform .1s,opacity .1s;
  }

  .logo{
    font-weight:900;
    font-size:48px; /* ADAPTIVE FIX */
    letter-spacing:-4px;
    transform:skewX(-12deg);
    user-select:none;
  }

  @media (max-width:400px){
    .logo{
      font-size:38px; /* мобильный */
    }
  }

  .gradient-text{
    background:linear-gradient(90deg,#4d9fff,#5d6bff,#904bff);
    -webkit-background-clip:text;
    color:transparent;
  }

  .white1{ color:#fff; }

  /* Кейсы */
  .cases-bar{
    position:fixed;
    top:140px;
    left:50%;
    transform:translateX(-50%);
    width:100%;
    max-width:600px; /* ADAPTIVE FIX */
    display:flex;
    justify-content:center;
    z-index:998;
    transition:transform .1s,opacity .1s;
  }

  .case{
    width:160px;
    height:220px;
    background:#1a1f35;
    border-radius:15px;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:10px;
    cursor:pointer;

    /* ADAPTIVE FIX */
    flex-shrink:0;
  }

  .case img.case-image{
    width:100%;
    aspect-ratio:1/1; /* КВАДРАТНОЕ ОКНО! */
    object-fit:cover;
    border-radius:12px;
    margin-bottom:10px;
  }

  .case .case-name{
    color:#fff;
    font-size:22px;
    font-weight:700;
    text-align:center;
  }

  /* Открытый кейс */
  .case-opened{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    width:95%;
    max-width:520px;
    background:#1a1f35;
    border-radius:20px;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:25px;
    z-index:1000;
  }

  .case-logo{
    position:absolute;
    top:18px;
    left:18px;
    cursor:pointer;
  }
  .case-logo .logo{
    font-size:32px;
  }

  .open-button{
    margin-top:16px;
    padding:12px 26px;
    background:#333;
    color:#fff;
    border:none;
    border-radius:12px;
    font-size:17px;
    cursor:pointer;
  }

  .open-button:disabled{
    opacity:.5;
    cursor:not-allowed;
  }

  .items-list{
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:8px;
    margin-top:18px;
  }

  .item-slot{
    width:70px;
    aspect-ratio:1/1;   /* КВАДРАТИК для предметов */
    background:#333;
    border-radius:12px;
    overflow:hidden;
    position:relative;
  }

  .item-slot img{
    width:100%;
    height:100%;
    object-fit:cover;
  }

  .rarity{
    position:absolute;
    bottom:4px;
    left:50%;
    transform:translateX(-50%);
    width:12px;
    height:12px;
    border-radius:50%;
  }

  .rarity.white{ background:white; }
  .rarity.red{ background:red; }

  /* Рулетка */
  .roulette{
    width:100%;
    max-width:500px;
    aspect-ratio:5/1; /* ADAPTIVE FIX — не ломается */
    overflow:hidden;
    border-radius:12px;
    margin-top:16px;
    background:#000;
    position:relative;
    border:2px solid rgba(255,255,255,.04);
  }

  .roulette::after{
    content:"";
    position:absolute;
    top:0;
    bottom:0;
    left:50%;
    width:4px;
    transform:translateX(-50%);
    background:rgba(255,255,255,.06);
    pointer-events:none;
  }

  .roulette-track{
    display:flex;
    position:absolute;
    left:0;
    top:0;
    height:100%;
    will-change:transform;
  }

  .roulette-item{
    height:100%;
    width:100px;
    flex-shrink:0;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .roulette-item img{
    width:100%;
    height:100%;
    object-fit:cover;
    border-radius:10px;
  }

  /* Результат */
  .result-block{
    margin-top:18px;
    display:none;
    flex-direction:column;
    align-items:center;
  }

  .result-title{
    color:#fff;
    font-size:22px;
    font-weight:700;
    text-align:center;
  }

  .result-actions{
    display:flex;
    gap:10px;
    margin-top:12px;
    flex-wrap:wrap;
    justify-content:center;
  }

  .result-btn{
    padding:10px 18px;
    border:none;
    border-radius:10px;
    font-weight:700;
    cursor:pointer;
  }

  .sell{ background:#ff4e4e; color:#fff; }
  .keep{ background:#4eff7a; color:#000; }

</style>
</head>
<body>

<div class="page-wrapper">

  <div class="logo-bar" id="logoBar">
    <div class="logo"><span class="gradient-text">StarW</span><span class="white1">1</span><span class="gradient-text">N</span></div>
  </div>

  <div class="cases-bar" id="casesBar">
    <div class="case" id="freeCase">
      <img class="case-image" src="../IMG/IMG_2086.WEBP" alt="FREE">
      <div class="case-name">FREE</div>
    </div>
  </div>

</div>

<div id="profileContainer"></div>



<script>
/* ========== АНИМАЦИЯ ШАПКИ ========== */
const logoBar = document.getElementById("logoBar");
const casesBar = document.getElementById("casesBar");

window.addEventListener("scroll", ()=>{
  let y = Math.min(window.scrollY,200);
  let o = 1 - y/200;
  logoBar.style.transform = `translate(-50%, -${y}px)`;
  logoBar.style.opacity = o;
  casesBar.style.transform = `translate(-50%, -${y}px)`;
  casesBar.style.opacity = o;
});

/* ========== ДАННЫЕ ДЛЯ КЕЙСА ========== */
const FREE_CASE_ITEMS = [
  { name:"Happy Brownie",rarity:"white",img:"../IMG/IMG_2046.WEBP" },
  { name:"Red 1",rarity:"red",img:"../IMG/IMG_2043.WEBP" },
  { name:"Red 2",rarity:"red",img:"../IMG/IMG_2010.WEBP" },
  { name:"Red 3",rarity:"red",img:"../IMG/IMG_2009.WEBP" },
  { name:"Red 4",rarity:"red",img:"../IMG/IMG_2008.WEBP" },
  { name:"Red 5",rarity:"red",img:"../IMG/IMG_2007.WEBP" },
  { name:"Red 6",rarity:"red",img:"../IMG/IMG_2006.WEBP" },
  { name:"Red 7",rarity:"red",img:"../IMG/IMG_2005.WEBP" },
  { name:"Red 8",rarity:"red",img:"../IMG/IMG_2004.WEBP" },
  { name:"Red 9",rarity:"red",img:"../IMG/IMG_2003.WEBP" },
];



/* ========== ОТКРЫТИЕ КЕЙСА ========== */
document.getElementById("freeCase").addEventListener("click",()=>{

  logoBar.style.display="none";
  casesBar.style.display="none";

  const openCase = document.createElement("div");
  openCase.className = "case-opened";
  openCase.innerHTML = `
      <div class="case-logo" id="backLogo">
        <div class="logo"><span class="gradient-text">StarW</span><span class="white1">1</span><span class="gradient-text">N</span></div>
      </div>

      <div style="color:#fff;font-size:26px;margin-top:22px;">FREE CASE</div>

      <div class="roulette" id="roulette">
        <div class="roulette-track" id="rouletteTrack"></div>
      </div>

      <button class="open-button" id="startOpen">ОТКРЫТЬ</button>

      <div class="items-list" id="itemsList"></div>

      <div class="result-block" id="resultBlock">
        <div class="result-title" id="resultTitle"></div>
        <div class="result-actions"></div>
      </div>
  `;

  document.body.appendChild(openCase);

  document.getElementById("backLogo").onclick = ()=>{
    openCase.remove();
    logoBar.style.display="flex";
    casesBar.style.display="flex";
  };


  /* СПИСОК ПРЕДМЕТОВ */
  const itemsList = document.getElementById("itemsList");
  FREE_CASE_ITEMS.forEach(it=>{
    let slot = document.createElement("div");
    slot.className = "item-slot";
    slot.innerHTML = `<img src="${it.img}"><div class="rarity ${it.rarity}"></div>`;
    itemsList.appendChild(slot);
  });


  /* РУЛЕТКА */
  const rouletteTrack = document.getElementById("rouletteTrack");
  const roulette = document.getElementById("roulette");
  const startOpen = document.getElementById("startOpen");
  const resultBlock = document.getElementById("resultBlock");
  const resultTitle = document.getElementById("resultTitle");
  const actions = resultBlock.querySelector(".result-actions");

  const seq=[];
  for(let r=0;r<30;r++){
    FREE_CASE_ITEMS.forEach(it=>seq.push(it));
  }

  seq.forEach(it=>{
    const d=document.createElement("div");
    d.className="roulette-item";
    d.innerHTML = `<img src="${it.img}">`;
    rouletteTrack.appendChild(d);
  });

  function getItemWidth(){
    const s=document.querySelector(".roulette-item");
    if(!s) return 100;
    return s.getBoundingClientRect().width;
  }

  let spinning=false;

  startOpen.onclick = ()=>{
    if(spinning) return;
    spinning=true;
    startOpen.disabled=true;

    resultBlock.style.display="none";

    const itemWidth=getItemWidth();
    const visibleWidth=roulette.getBoundingClientRect().width;
    const correction=Math.round((visibleWidth-itemWidth)/2);

    const winItem = FREE_CASE_ITEMS.find(i=>i.rarity==="white");
    const baseIndex = FREE_CASE_ITEMS.indexOf(winItem);

    const loops = 6 + Math.floor(Math.random()*3);
    const finalIndex = loops*FREE_CASE_ITEMS.length + baseIndex;
    const finalOffset = finalIndex*itemWidth - correction;

    rouletteTrack.style.transition="transform 2s linear";
    rouletteTrack.style.transform=`translateX(-1500px)`;

    setTimeout(()=>{
      rouletteTrack.style.transition="transform 3s cubic-bezier(.05,.6,.15,1)";
      rouletteTrack.style.transform=`translateX(-${finalOffset}px)`;
    },2000);

    setTimeout(()=>{
      resultTitle.textContent = `Тебе выпал: ${winItem.name}`;
      resultBlock.style.display="flex";
      spinning=false;
      startOpen.disabled=false;

      actions.innerHTML = `<button class="result-btn" style="background:#fff;color:#000;">Ок</button>`;
      actions.querySelector("button").onclick = ()=>{
        resultBlock.style.display="none";
      };

    },5200);
  };
});
</script>

</body>
</html>
